<xtml ns="xtml_dt_tree" light="false">  <Component id="TreeDataItems" type="data_items.Items" execution="native">    <Param name="TopXtml" />    <Param name="Type" />  </Component>    <Component id="TreeItemText" type="data.Data" execution="native" />    <Component id="TreeObject" type="data.Data" execution="native" >    <Param name="TopXtml" />  </Component>  <Component id="Tree" type="ui.Control">  <Param name="TopXtml"/>  <Param name="Type"/>  <Param name="HideEmpties" type="data.Boolean">    <Default value="true"/>  </Param>  <Param name="MainCircuit" type="action.Action" script="true"/>  <xtml t="ui.ItemList" Class="aa_xtml_tree" DataHolderCntr="">    <Var name="_SaveManager" t="xtml_dt_tree.SaveManager"/>    <Var name="_UndoData" t="xtml_dt_tree.UndoData"/>    <Var name="_HideEmpties" value="%$HideEmpties%"/>    <Var name="_XtmlTreeObj" t="xtml_dt_tree.TreeObject" TopXtml="%$TopXtml%">      <Method name="AfterUpdate" t="action.RunActions">        <Action t="object.RunMethod" Method="KeepCurrentPath" Object="%$_XtmlTreeObj%"/>        <Action t="uiaction.Refresh" RunOn=".xtml_editor_global_preview"/>      </Method>      <Method name="RunMainCircuit" t="xtml.UseParam" Param="MainCircuit"/>      <Method name="RefreshLocalPreview" t="async.RunOnNextTimer" Milliseconds="50">        <Action t="uiaction.ReplaceControl" RunOn="updown(.aaeditor_top,.xtml_editor_local_preview)">          <Var name="SelectedItem" value="%$_Item%"/>          <NewControl t="xtml_dt_tree.ShowWhenNotSlow" Class="xtml_editor_local_preview">            <Control t="xtml_dt_tree.HandlePreviewTimeout" MessageTextClass="hypelink_text" MessageClass="xtml_local_preview_cut_off" TextPattern="%%, click to recalc with no limits" Class="xtml_local_preview">              <Control t="ui.List">                <Control t="field.ShowFieldControl">                  <Field t="control.Button" ID="_Button" Title="Button" HideTitle="true">                    <Style t="btn.HyperlinkWithImage"/>                    <Image t="img.Image" Url="%$_Images%/studio/timer.gif">                      <AdjustSize t="img.Center"/>                    </Image>                    <FieldAspect t="field_feature.CssClass" ClassName="xtml_local_preview_cut_off"/>                    <FieldAspect t="field_feature.Css" Css="padding-right:15px"/>                    <Action t="action.RunActions">                      <Action t="object.SetBooleanProperty" Object="%$_XtmlTreeObj%" Property="CalcPreviewWithNoLimits" Value="true"/>                      <Action t="uiaction.Refresh" RunOn="up(.xtml_local_preview)"/>                      <Action t="object.SetBooleanProperty" Object="%$_XtmlTreeObj%" Property="CalcPreviewWithNoLimits" Value=""/>                    </Action>                  </Field>                </Control>                <Control t="aaeditor.PreviewControl" Class="xtml_editor_local_preview">                  <PreviewContext t="aaeditor.CalcLocalPreviewData">                    <MainCircuitRunner t="xtml.UseParam" Param="MainCircuit" Data=""/>                    <State t="aaeditor.State">                      <TreeXtml value="%$TopXtml%"/>                      <SelectedInTree t="object.RunMethod" Method="ObjectForPreview" Object="%$SelectedItem%" Input="%$SelectedItem%"/>                    </State>                  </PreviewContext>                </Control>              </Control>            </Control>          </NewControl>        </Action>      </Method>      <Property name="TopXtml" value="%$TopXtml%"/>    </Var>    <Items t="xtml_dt_tree.TreeDataItems" TopXtml="%$TopXtml%" Type="%$Type%"/>    <Aspect t="uiaspect.ItemImage">      <ItemImage t="object.RunMethod" Method="Image"/>    </Aspect>    <Aspect t="uiaspect.MaxTreeDepth" Depth="999"/>    <Aspect t="uiaspect.ItemSelection" AutoSelectFirstItem="select and focus">      <OnSelect t="action.RunActions">        <Action t="object.RunMethod" Method="RefreshLocalPreview" Object="%$_XtmlTreeObj%"/>        <Action t="object.RunMethod" Method="KeepCurrentPath" Object="%$_XtmlTreeObj%"/>      </OnSelect>    </Aspect>    <Aspect t="uiaspect.ExpandCollapse" CollapseLevel="first"/>    <Aspect t="uiaspect.ItemText" UsingHtmlElement="true">      <ItemText t="object.RunMethod" Method="Text"/>    </Aspect>    <Aspect t="uiaspect.NextLevelsLight"/>    <Aspect t="uiaspect.Indent" Lines="false"/>    <Aspect t="uiaspect.OnDoubleClick">      <Action t="object.RunMethod" Method="DoubleClick"/>    </Aspect>    <Aspect t="uiaspect.Shortcuts"/>    <Aspect t="uiaspect.Toolbar">      <MenuAspect t="operation.Presentation">        <Style t="ui.ButtonAsImage"/>      </MenuAspect>      <MenuAspect t="operation.OperationsByIDs" OperationIDs="GoUp,Save,Undo,Redo,GotoLastEdit,Delete,EditAsXml,Copy,Cut,Paste,MoveDown,MoveUp,Edit,More,EditAsLargeText,EditJavascript,EditPreviewProperties"/>    </Aspect>    <Aspect t="uiaspect.ContextMenu">      <MenuAspect t="operation.OperationsByIDs" OperationIDs="AddParam,EditAsXml,Delete,Cut,Copy,Paste,MoveDown,MoveUp,Edit,AAEditor"/>    </Aspect>    <Operations t="operation.Operations">      <Operation t="operation.Operation" ID="RightArrow" Shortcut="Right">        <Action t="object.RunMethod" Method="RightArrow"/>      </Operation>      <Operation t="operation.Operation" ID="AddParam" Title="Add Param" Shortcut="Ctrl+space" Icon="%$_Images%/add1616.gif">        <Condition value="%$HideEmpties%"/>        <Action t="operation.RunXtmlAction">          <Var name="ParamName" t="data.WritableText"/>          <Var name="ParamsList" t="object.RunMethod" Method="ParamsToAdd"/>          <Action t="dialog.TogglePopup" WidthOption="by css class" AutoFocusOn=".fld_param" PopupCssClass="xtml_dt_add_param_popup">            <Condition t="yesno.NotEmpty" Value="%$ParamsList%"/>            <OnElement t="data.Pipeline">              <Item value="%$_ElemsOfOperation%"/>              <Item t="ui.DataFromJavaScript" Expression="jQuery(data).find('.aa_text')"/>            </OnElement>            <Contents t="ui.List">              <Control t="ui.Text" Text="Use Param:" Class="title" CssStyle="padding: 3px 5px; display: inline-block;"/>              <Control t="field.ShowFieldControl">                <Item value="%$ParamName%"/>                <Field t="field.XmlField" Path="" ID="param">                  <FieldAspect t="field_aspect.CustomSuggestionBox">                    <OnChangeAtEndOfText t="field_aspect.OpenSuggestionBoxList" HalfWrittenPart="%%" Options="%$ParamsList%">                      <OptionImage t="text.FirstSucceeding">                        <Item value="%@icon%"/>                        <Item value="%$_Images%/studio/cube.png"/>                      </OptionImage>                      <OptionLabel t="text.FirstSucceeding">                        <Item value="%@title%"/>                        <Item value="%@name%"/>                      </OptionLabel>                      <OptionDescription value="%@description%%@Description%%$Def%">                        <Var name="Def" value=" (%@Default%%Default/@value%%Default/@t%)">                          <Condition t="yesno.NotEmpty" Value="%@Default%%Default/@value%%Default/@t%"/>                        </Var>                      </OptionDescription>                      <OnSelect t="action.RunActions">                        <Action t="dialog.ClosePopup"/>                        <Action t="object.RunMethod" Method="AddParam" Object="%$_ItemsOfOperation%" Input="%$_ItemsOfOperation%">                          <Param name="Param" value="%%"/>                        </Action>                      </OnSelect>                    </OnChangeAtEndOfText>                  </FieldAspect>                  <FieldAspect t="field_feature.HandleEvent">                    <Event t="field_feature.KeyUp"/>                    <Action t="action.RunActions">                      <Condition t="yesno.And">                        <Item t="text.ItemsEqual" Item1="%$KeyCode%" Item2="37"/>                        <Item t="yesno.IsEmpty"/>                      </Condition>                      <Action t="dialog.ClosePopup">                      </Action>                      <Action t="uiaction.Focus" RunOn="%$_ElemsOfOperation%"/>                    </Action>                  </FieldAspect>                  <FieldAspect t="field_feature.Css" Css="#this:focus { outline:none; background:none; } " />                </Field>              </Control>              <Layout t="ui.Horizontal"/>            </Contents>            <OnPopupOpen t="field_aspect.TriggerSuggestionBoxPopup" RunOn=".fld_param"/>            <OnSuccess t="object.RunMethod" Method="AddParam">              <Param name="SimpleParam" value="%$ParamName%"/>            </OnSuccess>            <OnCancel t="uiaction.Focus" RunOn="%$_ElemsOfOperation%"/>          </Action>        </Action>      </Operation>      <Operation1 t="operation.Operation" Icon="%$_Images%/save.jpg" ID="Save" Title="Save" Shortcut="Ctrl+Shift+s">        <Disabled t="object.RunMethod" Object="%$_SaveManager%" Method="NoModified"/>        <Action t="object.RunMethod" Object="%$_SaveManager%" Method="Save"/>      </Operation1>      <Operation t="operation.Operation" Icon="%$_Images%/studio/undo.png" ID="Undo" Title="Undo" Shortcut="Ctrl+z">        <Action t="object.RunMethod" Method="Undo" Object="%$_XtmlTreeObj%"/>        <Condition t="yesno.NotEmpty" Value="%$_UndoData/UndoOperations%"/>      </Operation>      <Operation t="operation.Operation" Icon="%$_Images%/studio/redo.png" ID="Redo" Title="Redo" Shortcut="Ctrl+y">        <Action t="object.RunMethod" Method="Undo">          <Param name="Redo" value="true"/>        </Action>        <Condition t="yesno.NotEmpty" Value="%$_UndoData/RedoOperations%"/>      </Operation>      <Operation t="operation.Operation" ID="GotoLastEdit" Icon="%$_Images%/studio/goto_last_edit.png" Title="Goto Last Edit" Shortcut="Ctrl+q">        <Condition t="yesno.NotEmpty" Value="%$_UndoData/UndoOperations%"/>        <Action t="object.RunMethod" Method="Undo">          <Param name="GotoLastEdit" value="true"/>        </Action>      </Operation>      <Operation t="operation.Operation" Icon="%$_Images%/studio/xmldoc.gif" ID="EditAsXml" Title="Xml..." Shortcut="Ctrl+Shift+x">        <Disabled t="object.RunMethod" Method="HasNoContent"/>        <Action t="xmlui.ShowXmlDialog">          <Xml t="object.RunMethod" Method="AsXml"/>          <OnUpdate t="object.RunMethod" Method="Update" Object="%$_ItemsOfOperation%" Input="%$_ItemsOfOperation%">            <Param name="Xml" value="%%"/>          </OnUpdate>          <Title t="text.RemoveSuffix" Separator=" =">            <Data t="object.RunMethod" Method="Text"/>          </Title>          <OnCancel t="uiaction.Focus" RunOn="%$_ElemsOfOperation%"/>        </Action>      </Operation>      <Operation t="operation.Operation" Icon="%$_Images%/studio/copy.png" ID="Copy" Title="Copy" Shortcut="Ctrl+c">        <Disabled t="object.RunMethod" Method="HasNoContent"/>        <Action t="object.RunMethod" Method="Copy"/>      </Operation>      <Operation t="operation.Operation" Icon="%$_Images%/studio/cut.png" ID="Cut" Title="Cut" Shortcut="Ctrl+x">        <Disabled t="object.RunMethod" Method="HasNoContent"/>        <Action t="object.RunMethod" Method="Cut"/>      </Operation>      <Operation t="operation.Operation" Icon="%$_Images%/studio/paste.png" ID="Paste" Title="Paste" Shortcut="Ctrl+v">        <Disabled t="object.RunMethod" Method="IsActionDisabled">          <Param name="Operation" value="Paste"/>        </Disabled>        <Action t="object.RunMethod" Method="Paste"/>      </Operation>      <Operation t="operation.Operation" Icon="%$_Images%/studio/delete21616.gif" ID="Delete" Title="Delete" Shortcut="delete">        <Disabled t="object.RunMethod" Method="HasNoContent"/>        <Action t="object.RunMethod" Method="Delete"/>      </Operation>      <Operation t="operation.Operation" Icon="%$_Images%/studio/down1616.gif" ID="MoveDown" Title="Move Down" Shortcut="Ctrl+down">        <Disabled t="object.RunMethod" Method="IsActionDisabled">          <Param name="Operation" value="MoveDown"/>        </Disabled>        <Action t="object.RunMethod" Method="Move">          <Param name="Direction" value="down"/>        </Action>      </Operation>      <Operation t="operation.Operation" Icon="%$_Images%/up1616.gif" ID="MoveUp" Title="Move Up" Shortcut="Ctrl+up">        <Disabled t="object.RunMethod" Method="IsActionDisabled">          <Param name="Operation" value="MoveUp"/>        </Disabled>        <Action t="object.RunMethod" Method="Move">          <Param name="Direction" value="up"/>        </Action>      </Operation>      <Operation t="operation.Operation" Icon="%$_Images%/edit1616.gif" ID="Edit" Title="Edit..." Target="item">        <Action t="xtml_dt_tree.OpenPrimitivePopup" Enum=""/>      </Operation>      <Operation t="operation.Operation" ID="More" Title="More" Shortcut="Ctrl+m" Icon="%$_Images%/studio/more2.gif" Target="item">        <Disabled t="object.RunMethod" Method="HasNoContent"/>        <Action t="operation.RunXtmlAction">          <Var name="ComponentsList" t="data.Pipeline">            <Item t="xtml.TypeDefinition" Type="%$_ItemsOfOperation/_Type%"/>            <Item value="%MoreComponents/component%"/>          </Var>          <Action t="dialog.TogglePopup" WidthOption="by css class" AutoFocusOn=".fld_param" PopupCssClass="xtml_dt_add_param_popup" CloseOnEnter="true" CloseOnDoubleClick="true" Picklist="" AutoCloseOnMouseOut="" ShowCloseButton="">            <Condition t="yesno.NotEmpty" Value="%$ComponentsList%"/>            <OnElement t="data.Pipeline">              <Item value="%$_ElemsOfOperation%"/>              <Item t="ui.DataFromJavaScript" Expression="jQuery(data).find('.aa_text')"/>            </OnElement>            <Contents t="ui.List">              <Control t="ui.Text" Text="More:" Class="title"/>              <Control t="field.ShowFieldControl">                <Item t="data.WritableText"/>                <Field t="field.XmlField" Path="" ID="param">                  <FieldAspect t="field_aspect.CustomSuggestionBox">                    <OnChangeAtEndOfText t="field_aspect.OpenSuggestionBoxList" Options="%$ComponentsList%" HalfWrittenPart="%%" OptionImage="%$_Images%/studio/more2.gif">                      <OptionLabel t="data.Pipeline">                        <Item t="text.Split" Separator="." Part="Second" Data="%@id%"/>                        <Item t="text.Capitalize" Mode="capital to separate words"/>                      </OptionLabel>                      <OnSelect t="action.RunActions">                        <Action t="dialog.ClosePopup"/>                        <Action t="object.RunMethod" Method="More" Object="%$_ItemsOfOperation%" Input="%$_ItemsOfOperation%">                          <Param name="MoreComponent" value="%%"/>                        </Action>                      </OnSelect>                    </OnChangeAtEndOfText>                  </FieldAspect>                </Field>              </Control>              <Layout t="ui.Horizontal"/>            </Contents>            <OnPopupOpen t="field_aspect.TriggerSuggestionBoxPopup" RunOn=".fld_param"/>            <OnCancel t="uiaction.Focus" RunOn="%$_ElemsOfOperation%" OnFirstInput=""/>          </Action>        </Action>      </Operation>      <Operation t="operation.Operation" Shortcut="Ctrl+Enter" Title="Edit as large text ..." ID="EditAsLargeText" Icon="%$_Images%/studio/fullscreen.gif">        <Action t="aaeditor.OpenPrimitiveAsDialog">          <Data t="object.RunMethod" Method="AsPrimitive" Object="%$_ItemsOfOperation%"/>          <RunOnOK t="object.RunMethod" Method="Update" Object="%$_ItemsOfOperation%">            <Param name="Value" value="%%"/>          </RunOnOK>          <RunOnCancel t="uiaction.Focus" RunOn="%$_ElemsOfOperation%"/>        </Action>        <Disabled t="yesno.And">          <Data t="object.RunMethod" Method="GetXtml" Object="%%"/>          <Item t="yesno.NotEmpty" Value="%@t%"/>        </Disabled>      </Operation>      <Operation t="operation.Operation" Icon="%$_Images%/studio/arrow_up.png" ID="GoUp" Title="Go Up" Target="item">        <Disabled t="yesno.OR">          <Item t="yesno.IsEmpty" Value="%$TopXtml/..%"/>          <Item t="yesno.Not">            <Of t="object.RunMethod" Method="IsTop"/>          </Item>        </Disabled>        <Action t="uiaction.ReplaceControl" RunOn="up(.aa_xtml_tree)">          <NewControl t="xtml_dt_tree.Tree" TopXtml="%$TopXtml/..%" HideEmpties="%$HideEmpties%">            <MainCircuit t="xtml.UseParam" Param="MainCircuit"/>            <Type t="data.Pipeline">              <Item t="xtml.ComponentDefinition" ID="%$TopXtml/../@t%"/>              <Item value="%@type%"/>            </Type>          </NewControl>        </Action>      </Operation>      <Operation t="operation.Operation" ID="EditPreviewProperties" Target="item" Title="Edit Preview Properties" Icon="%$_Images%/enum.gif">        <Action t="popup.OpenPopup" PopupTitle="Preview Properties">          <Var name="PreviewSettings" t="xtml_dt_tree.PreviewSettings"/>          <Style t="gstudio.GoogleDrivePopup">&#xa;          </Style>          <Contents t="field.InnerPage">            <Layout t="layout.Default"/>            <Field t="control.PropertySheet" ID="_Property_Sheet" Title="Property Sheet">              <Style t="properties.Default" PropertiesWidth="146px"/>              <Field t="fld.Field" ID="MaxItemsToFind" Title="Stop after # items found">                <FieldType t="fld_type.EditableText">                  <Style t="editable_text.JBartTextbox" Width="150px"/>                </FieldType>                <FieldData t="data.SessionStorage" Key="Preview_MaxItemsToFind"/>                <FieldAspect t="field_aspect.DefaultValue" Value="%$PreviewSettings/MaxItemsToFind%"/>              </Field>              <Field t="fld.Field" ID="MaxTime" Title="Stop time out">                <FieldType t="fld_type.EditableText">                  <Style t="editable_text.JBartTextbox" Width="150px"/>                </FieldType>                <FieldData t="data.SessionStorage" Key="Preview_MaxTime"/>                <FieldAspect t="field_aspect.DefaultValue" Value="%$PreviewSettings/MaxTime%"/>                <FieldAspect t="field_aspect.Description" Description="in miliseconds"/>              </Field>              <Field t="fld.Field" ID="MaxTableViewTime" Title="Table view timeout">                <FieldType t="fld_type.EditableText">                  <Style t="editable_text.JBartTextbox" Width="150px"/>                </FieldType>                <FieldData t="data.SessionStorage" Key="Preview_MaxTableViewTime"/>                <FieldAspect t="field_aspect.DefaultValue" Value="%$PreviewSettings/MaxTableViewTime%"/>                <FieldAspect t="field_aspect.Description" Description="when time passes, 'show more items' is shown"/>              </Field>              <Field t="fld.Field" ID="MaxCharsToShow" Title="Max Chars to Show">                <FieldType t="fld_type.EditableText">                  <Style t="editable_text.JBartTextbox" Width="150px"/>                </FieldType>                <FieldData t="data.SessionStorage" Key="Preview_MaxCharsToShow"/>                <FieldAspect t="field_aspect.DefaultValue" Value="%$PreviewSettings/MaxCharsToShow%"/>                <FieldAspect t="field_aspect.Description" Description="Limit visible text on the preview output"/>              </Field>            </Field>            <Field t="control.Button" ID="_Button" Title="Close" HideTitle="true">              <Style t="btn.JBartGrey" MinWidth="60px"/>              <Action t="popup.CloseContainingPopup" ExitMode=""/>              <FieldAspect t="field_feature.Layout">                <Css><![CDATA[#this { float: left; margin-right: 0px;   margin-bottom: 21px; margin-top: 22px; }#wrapper { }]]></Css>              </FieldAspect>            </Field>          </Contents>          <Feature t="popup.CloseOnEnter"/>        </Action>      </Operation>    </Operations>    <Aspect t="uiaspect.RunAction">      <RunAfterControl t="action.RunActions">        <Action t="object.RunMethod" Method="SetTreeTop" Object="%$_XtmlTreeObj%"/>        <Action t="object.RunMethod" Method="GoToPreviousPath" Object="%$_XtmlTreeObj%"/>      </RunAfterControl>    </Aspect>  </xtml></Component>  <Component id="PreviewSettings" execution="native" />  <Component id="UndoData" type="data.Data" hidden="true">    <xtml t="object.Object">      <Property name="UndoOperations" t="data.List" />      <Property name="RedoOperations" t="data.List" />    </xtml>  </Component>    <Component id="OpenScriptDialog" type="action.Action" description="compatible with old aaeditor" light="false">    <Param name="RunOnOK" type="action.Action" script="true" />    <xtml t="xtml_dt_tree.OpenScriptEditor" Xtml="%$AAEditorState/TreeXtml/script%" >       <Var name="TopCircuit" t="aaeditor.CalculateTopCircuit" Xtml="%$AAEditorState/TreeXtml/script%" />       <XtmlType t="data.Pipeline">         <Item t="xtml.ComponentDefinition" ID="%@t%" Data="%$AAEditorState/TreeXtml/script%" />         <Item value="%@type%" />       </XtmlType>       <GlobalPreview t="object.RunMethod" Object="%$TopCircuit%" Method="GlobalPreview" />       <MainCircuit t="object.RunMethod" Object="%$TopCircuit%" Method="RunCircuit" />       <Title t="text.FirstSucceeding" Data="%$AAEditorState/TreeXtml/script%" >        <Item value="%@Title%" />        <Item value="%@ID%" />        <Item value="%@Path%" />        <Item value="%@Name%" />        <Item t="xml.Tag" />       </Title>       <RunOnClose t="xtml.UseParam" Param="RunOnOK" />    </xtml>  </Component>    <Component id="OpenScriptEditor" type="action.Action">    <Param name="Xtml" />    <Param name="XtmlType" />    <Param name="GlobalPreview" type="ui.Control" script="true" />    <Param name="MainCircuit" type="ui.Action" script="true" />    <Param name="Title" ><Default value="Script Editor" /></Param>    <Param name="RunOnClose" type="action.Action" script="true" />    <xtml t="dialog.OpenDialog" >      <Dialog t="dialog.Dialog" CloseOnEnter="false" CloseOnEsc="false" FullScreen="true" AlwaysLTR="true" Buttons="" Class="aaeditor" Title="%$Title%">        <AutoFocus t="xtml_dt_tree.FindTreeTopInDialog" />        <RunOnClose t="xtml.UseParam" Param="RunOnClose" />        <Content t="ui.SectionsList" Class="aaeditor_top">          <Var name="_XtmlDtTreeTimeCalculator" t="object.Object"/>          <Var name="_XtmlDtDialog" t="object.Object">            <Method name="RunOnClose" t="xtml.UseParam" Param="RunOnClose" />          </Var>          <Section t="ui.SectionListPage" Title="Script">            <Control t="xtml_dt_tree.Tree" TopXtml="%$Xtml%" Type="%$XtmlType%">              <MainCircuit t="xtml.UseParam" Param="MainCircuit" />            </Control>          </Section>          <Section t="ui.SectionListPage" Title="Local Preview">            <Control t="ui.List" Class="xtml_editor_local_preview" >              <Control t="ui.Text" />            </Control>          </Section>          <Section t="ui.SectionListPage" Title="Global Preview">            <Control t="ui.List" Class="xtml_editor_global_preview" >              <Control t="xtml_dt_tree.ShowWhenNotSlow" >                <Control t="data.MeasureCalculationTime" PutTimeInObject="%$_XtmlDtTreeTimeCalculator%" PutTimeInProperty="MainCircuitTime">                  <Calculation t="xtml.UseParam" Param="GlobalPreview" />                </Control>              </Control>             </Control>          </Section>          <Style t="ui.HorizontalSplitter" IdForCookie="aaeditor">            <Height t="ui.ScreenSize" Axis="height" Margin="100" AsHtmlString="true" />            <TotalWidth t="ui.ScreenSize" Axis="width" Margin="100" />            <DefaultWidths t="data.ListByCommas" List="320px,400px" />          </Style>        </Content>        </Dialog>    </xtml>  </Component>    <Component id="ShowWhenNotSlow" type="ui.Control">    <Param name="Control" type="ui.Control" script="true" />    <xtml t="ui.List" Class="dowhennotslow" >      <Control t="data.IfThenElse">        <If t="yesno.GreaterThan" Item="%$_XtmlDtTreeTimeCalculator/MainCircuitTime%" Than="10000" />        <If1 t="yesno.NotEmpty" Value="%$_XtmlDtTreeTimeCalculator/MainCircuitTime%" Than="1" />        <Then t="ui.ButtonOld" Text="Slow mode, click here to show preview" >          <Style t="ui.ButtonAsHyperlink" />          <OnClick t="action.RunActions" >            <Action t="object.SetProperty" Object="%$_XtmlDtTreeTimeCalculator%" Property="MainCircuitTime" Value="" />            <Action t="uiaction.Refresh" RunOn="up(.dowhennotslow)" />          </OnClick>        </Then>        <Else t="xtml.UseParam" Param="Control" />      </Control>    </xtml>  </Component>    <Component id="OpenCodeMirror" type="action.Action">    <xtml t="action.RunActions">      <Action t="xml.WriteCData" Element="%!{$ParamXml/@name}%">        <Condition t="yesno.IsEmpty" Value="%{$ParamXml/@name}%" />        <Value t="xtml.RunXtml" Xtml="%$ParamXml%" Field="Default" />      </Action>      <Action t="gstudio_popup.ShowEditCodeMirrorPopup" ParamXml="%$ParamXml%" Xtml="%%" />    </xtml>  </Component>  <Component id="OpenPrimitivePopup" type="action.Action">      <Param name="ParamXml"/>      <Param name="Enum" type="data.Boolean"/>      <xtml t="dialog.TogglePopup" WidthOption="by css class" AutoFocusOn=".fld_primitive_text_box" ReturnFocusTo1="%$_ElemsOfOperation%" PopupCssClass="xtml_dt_popup">        <Var name="_Xtml" t="xtml_dt.ProfileProperty" Profile="%ParentXtml%" Param="%Param%"  />        <Var name="Text" t="data.WritableText">          <DefaultValue t="object.RunMethod" Method="AsPrimitive"/>        </Var>        <Var name="ContextCalculator" t="data.JustInTimeCalculation">          <Content t="aaeditor.CalcLocalPreviewData">            <MainCircuitRunner t="xtml_dt_tree.ShowWhenNotSlow" >              <Control t="object.RunMethod" Method="RunMainCircuit" Object="%$_XtmlTreeObj%"/>            </MainCircuitRunner>            <State t="aaeditor.State" TreeXtml="%$AAEditorState/TreeXtml%">              <SelectedInTree t="object.RunMethod" Method="ObjectForPreview" Object="%$_ItemsOfOperation%" Input="%$_ItemsOfOperation%"/>            </State>          </Content>        </Var>        <OnSuccess t="object.RunMethod" Method="Update">          <Param name="Value" value="%$Text%"/>        </OnSuccess>        <OnElement t="data.Pipeline">          <Item value="%$_ElemsOfOperation%"/>          <Item t="ui.DataFromJavaScript" Expression="jQuery(data).find('.aa_text')"/>        </OnElement>        <Contents t="ui.List" >          <Control t="aaeditor.EditPrimitiveTextBox" Data="%$Text%" OnlyPrimitive="%$OnlyPrimitive%" Param="%$ParamXml%" Simple="false">            <Context t="object.RunMethod" Method="GetContent" Object="%$ContextCalculator%"/>            <OnSelectComponent t="action.RunActions">              <Action t="dialog.ClosePopup"/>              <Action t="object.RunMethod" Method="Update" Object="%$_ItemsOfOperation%" Input="%$_ItemsOfOperation%">                <Param name="Value" t="data.IfThenElse" If="%$_Enum%" Then="%%" Else="=%%"/>              </Action>            </OnSelectComponent>          </Control>          <Control1 t="ui.Image" Source="%$_Images%/openmenu.gif" CssStyle="cursor:pointer">            <OnClick t="menu.OpenContextMenu">              <Menu t="menu.ContextMenu">                <Item t="menu.MenuItem" Text="Edit as Large Text ..." Image="%$_Images%/studio/r.gif"/>              </Menu>            </OnClick>          </Control1>          <Layout t="ui.Horizontal" VerticalAlign="middle" Padding="4px"/>        </Contents>        <OnPopupOpen t="action.RunActions" Remark="auto select non data" RunOn=".fld_primitive_text_box">          <Action t="uiaction.SetText" Text="=" Remark="add = for empty value">            <Condition t="yesno.And">              <Item t="yesno.IsEmpty" Value="%$Text%"/>              <Item t="yesno.NotEmpty" Value="%$ParamXml/@type%"/>              <Item t="yesno.NotInList" Item="%$ParamXml/@type%">                <List t="data.ListByCommas" List="data.Data,data.Data[],enum,dynamic_enum,dynamic_enum_multi,data.Boolean,data.Boolean[]"/>              </Item>              <Item t="yesno.Not" Of="%$OnlyPrimitive%"/>            </Condition>          </Action>          <Action t="async.RunOnNextTimer" Milliseconds="1">            <Action t="uiaction.SetTextSelectionOld" SelectionStart="1" Remark="select all but the ="/>            <Condition t="text.StartsWith" Text="%$Text%" With="="/>          </Action>          <Action t="action.Switch">            <Case Remark="component">              <IfCondition t="text.StartsWith" Text="%$Text%" With="="/>              <Then t="field_aspect.TriggerSuggestionBoxPopup" TextToSimulate="="/>            </Case>            <Case Remark="enum">              <IfCondition t="yesno.IsInList" Item="%$ParamXml/@type%">                <List t="data.ListByCommas" List="enum,dynamic_enum,dynamic_enum_multi"/>              </IfCondition>              <Then t="field_aspect.TriggerSuggestionBoxPopup" TextToSimulate=""/>            </Case>          </Action>        </OnPopupOpen>        <OnCancel t="uiaction.Focus" RunOn="%$_ElemsOfOperation%"/>      </xtml>    </Component>    <Component id="SaveManager" type="data.Data" execution="native" />    <Component id="SaveToServer" type="action.Action">    <xtml t="aaeditor.SaveToServerAction" />  </Component>    <Component id="FindTreeTopInDialog" type="data.Data" execution="native" />    <Component id="ComponentDef">      <Param name="xtml" only_element="true" type="parent_type"/>      <Param name="type" type="dynamic_enum" essential="true">        <Options t="xtml.AllTypes"/>      </Param>      <Param name="Param" type="inline[]" has_name="true">        <Param name="name" essential="true" only_primitive="true"/>        <Param name="type" type="dynamic_enum" essential="true">          <Options t="xtml.AllTypes"/>        </Param>        <Param name="description" essential="true" only_primitive="true"/>        <Param name="essential" type="data.Boolean" essential="true"/>        <Param name="Default" type="parent_type" only_element="true"/>        <Param name="script" type="data.Boolean"/>        <Param name="advanced" type="data.Boolean"/>        <Param name="Title" only_primitive="true"/>        <Param name="RunningInput" Description="for better preview in case of action/operation"/>        <Param name="FieldAspect" type="field.FieldAspect[]"/>      </Param>      <Param name="execution" type="enum">        <value>native</value>        <value>xtml</value>      </Param>      <Param name="description" type="data.Boolean"/>      <Param name="hidden" type="data.Boolean"/>      <Param name="databind" type="data.Boolean"/>      <Param name="id" only_primitive="true"/>      <Param name="gallery"/>      <Param name="light" type="data.Boolean"/>    </Component>  <Component id="OpenXmlDialog" type="dialog.Dialog">      <xtml t="dialog.OpenDialog">        <Dialog t="dialog.Dialog" Title="Update xml" AutoFocus="XmlBox" AlwaysLTR="true">          <Var name="XmlAsText" t="data.WritableText">            <DefaultValue t="xml.XmlToText" Data="%Xml%" PrettyPrint="true"/>          </Var>          <Var name="DynamicContent" t="data.WritableText" DefaultValue="%DynamicContent%"/>          <Var name="Xtml" value="%ParentXtml%"/>          <Content t="ui.List">            <Control t="ui.List">              <Control t="ui.ButtonOld" Text="Insert Dynamic Value ..." Image="%$_Images%/add1616.gif">                <Style t="ui.ButtonAsHyperlink"/>                <OnClick t="dialog.OpenDialog">                  <Dialog t="dialog.Dialog" Title="Insert Dynamic Value">                    <Content t="ui.Document">                      <Fields t="field.Field1" Title="Expression">                        <Control t="aaeditor.EditPrimitiveTextWithPreview" DisableLargeText="true" Simple="false">                          <Context t="aaeditor.CalcLocalPreviewData" >                            <MainCircuitRunner t="object.RunMethod" Method="RunMainCircuit" Object="%$_XtmlTreeObj%"/>                            <State t="aaeditor.State">                              <TreeXtml value="%$_XtmlTreeObj/TopXtml%"/>                              <SelectedInTree t="aaeditor.TreeItemData" Xtml="%$Xtml%"/>                            </State>                          </Context>                        </Control>                      </Fields>                    </Content>                    <DialogData t="data.WritableText"/>                    <RunOnOK t="action.RunActions">                      <Action t="xmlui.InsertTextToCodeMirror" Text="%%" RunOn="updown(.dialog_box,.xmltext)"/>                      <Action t="action.WriteValue" To="%$DynamicContent%" Value="true"/>                      <Action t="uiaction.Refresh" RunOn=".fld_dynamic_content"/>                    </RunOnOK>                  </Dialog>                </OnClick>              </Control>              <Control t="field.ShowFieldControl" Class="fld_dynamic_content">                <Field t="field.Field" FieldData="%$DynamicContent%" Title="Dynamic Content" >                  <Type t="field_aspect.Boolean" />                </Field>              </Control>              <Layout t="ui.Horizontal" VerticalAlign="middle"/>            </Control>            <Control t="ui.Document">              <Fields t="field.Fields">                <Field1 t="field.Field1" FieldData="%$DynamicContent%" Title="Dynamic Content" ID="dynamic_content">                  <FieldAspect t="field_aspect.Boolean"/>                </Field1>                <Field t="field.Field1" FieldData="%$XmlAsText%" Title="Content">                  <FieldAspect t="field_aspect.HideTitle"/>                  <FieldAspect t="field_aspect.Control">                    <Control t="xmlui.CodeMirrorTextarea" Type="xml" AutoFocus="true" Data="%$XmlAsText%" Class="xmltext" Height="350px">                      <Width t="ui.ScreenSize" Axis="width" Margin="300" AsHtmlString="true"/>                    </Control>                  </FieldAspect>                </Field>              </Fields>            </Control>            <Control t="xml.Xml"/>          </Content>          <Validations t="ui.ValidationList">            <Validation t="ui.Validation" Message="invalid xml: %$Error%">              <Var name="Error" t="xml.XmlParsingError" Data="%$XmlAsText%"/>              <SuccessCondition t="yesno.IsEmpty" Value="%$Error%"/>            </Validation>            <Validation t="xmlui.CallUpdateOfCodeMirror" RunOn="updown(.dialog_box,.xmltext)"/>          </Validations>          <RunOnOK t="object.RunMethod" Method="OnOK">            <Input t="object.Object" >              <Property name="Xml" t="xml.TextToXml" Data="%$XmlAsText%"/>              <Property name="DynamicContent" value="%$DynamicContent%" />            </Input>          </RunOnOK>          <RunOnCancel t="uiaction.Focus" RunOn="%$_ElemsOfOperation%"/>        </Dialog>      </xtml>    </Component>  <Component id="HandlePreviewTimeout" type="ui.Control" databind="true" execution="native" >    <Param name="Control" Description="Control that activates preview runner"/>    <Param name="MessageClass" />    <Param name="MessageTextClass" />    <Param name="AttachCtrlSpace" type="data.Boolean"/>  </Component></xtml>