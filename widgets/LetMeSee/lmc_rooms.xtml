<xtml ns="lmc" altc="true"><Component id="RoomsTable" type="jbart.MyWidgetPage">  <Param name="Rooms"/>  <Param name="IsManager" type="data.Boolean"/>  <Param name="IsArchive" type="data.Boolean"/>  <Param name="IsRoomClickable" type="data.Boolean" Default="true"/>  <xtml t="field.ItemListContainer" ID="rooms_cntr" Title="rooms">    <Field t="control.Layout" ID="_Cntr_FilterGroup" Title="Filters">      <Layout t="layout.Horizontal" VerticalLayoutForMobileWidth="false" Spacing="20"/>      <FieldAspect t="itemlist_aspect.FilterGroup"/>      <FieldAspect t="field_feature.Layout">        <Css><![CDATA[#this { padding-bottom: 5px; }]]></Css>      </FieldAspect>      <Field t="fld.Field" Title="Find Name" ID="Filter_fast_find" ReadOnlyText="" FieldData="%!@Filter_fastfind%">        <FieldType t="fld_type.EditableText">          <Style t="editable_text.JBartTextbox" Width="150px"/>        </FieldType>        <FieldAspect t="itemlist_aspect.Filter" ImmediateFilter="true">          <FilterType t="itemlist_filter.Text"/>          <FieldData t="data.Pipeline">            <Item t="data.List">              <Item value="%@customerName%"/>              <Item t="data.Pipeline">                <Item value="%props%"/>                <Item t="xml.Attributes"/>              </Item>            </Item>            <Aggregator t="text.Concat" Separator=" "/>          </FieldData>        </FieldAspect>        <FieldAspect t="field_aspect.DescriptionForEmptyText" Description="Search"/>        <FieldAspect t="field_aspect.ItemListSelectionWithKeyboard"/>      </Field>      <Field t="fld.Field" Title="Find Project" ID="Filter_project" ReadOnlyText="" FieldData="%!@Filter_project%">        <FieldType t="fld_type.Picklist" AllowEmptyValue="true" AllowValueNotInOptions="">          <Options t="editable_picklist.AutoFilterOptions" NameForEmptyValue="no project"/>          <Style t="editable_picklist.JBartPicklist" Width="106px"/>        </FieldType>        <FieldAspect t="itemlist_aspect.Filter" FieldData="%../../@name%" ImmediateFilter="true">          <FilterType t="itemlist_filter.ExactMatch" ValuesMultiple="false" QueryMultiple="false"/>        </FieldAspect>        <FieldAspect t="field_aspect.DescriptionForEmptyText" Description="Project"/>        <FieldAspect t="itemlist_filter.Occurrences" ShowFilteredOccurrences="true" SortByOccurrences="true">          <Style t="occurrences.Default"/>        </FieldAspect>        <FieldAspect t="field_aspect.Hidden">          <OnCondition t="field_aspect.CheckConditionForEveryItem" ShowCondition="%$IsManager%" DataForCondition="Item data" WhenHidden="Do not render"/>        </FieldAspect>      </Field>      <Field t="fld.Field" Title="Find Agent" ID="Filter_agent" ReadOnlyText="" FieldData="%!@Filter_agrnt%">        <FieldType t="fld_type.Picklist" AllowEmptyValue="true" AllowValueNotInOptions="">          <Options t="editable_picklist.AutoFilterOptions" NameForEmptyValue="no agent"/>          <Style t="editable_picklist.JBartPicklist" Width="106px"/>        </FieldType>        <FieldAspect t="itemlist_aspect.Filter" FieldData="%@agent%" ImmediateFilter="true">          <FilterType t="itemlist_filter.ExactMatch" ValuesMultiple="false" QueryMultiple="false"/>        </FieldAspect>        <FieldAspect t="field_aspect.DescriptionForEmptyText" Description="Agent"/>        <FieldAspect t="itemlist_filter.Occurrences" ShowFilteredOccurrences="true" SortByOccurrences="true">          <Style t="occurrences.Default"/>        </FieldAspect>      </Field>      <Field t="fld.Field" Title="Status" ID="Filter_status" ReadOnlyText="" FieldData="%!@Filter_status%">        <FieldType t="fld_type.Picklist" AllowEmptyValue="true" AllowValueNotInOptions="">          <Options t="editable_picklist.AutoFilterOptions" NameForEmptyValue="no agent"/>          <Style t="editable_picklist.JBartPicklist" Width="106px"/>        </FieldType>        <FieldAspect t="itemlist_aspect.Filter" FieldData="%@customerStatus%" ImmediateFilter="true">          <FilterType t="itemlist_filter.ExactMatch" ValuesMultiple="false" QueryMultiple="false"/>        </FieldAspect>        <FieldAspect t="field_aspect.DescriptionForEmptyText" Description="Status"/>        <FieldAspect t="itemlist_filter.Occurrences" ShowFilteredOccurrences="true" SortByOccurrences="true">          <Style t="occurrences.Default"/>        </FieldAspect>      </Field>    </Field>    <Items t="itemlist.Items" Items="%$Rooms%"/>    <Field t="field.ItemList" Title="rooms" ID="rooms_table">      <View t="ui.CustomCss" base="itemlist_style.JBartTable">        <Style t="itemlist_style.JBartTable" MinWidth="540px"/>        <Css><![CDATA[#this >table {  color: #404040;  width: 100\%;  border: 1px #ccc solid;  border-collapse: collapse;  border-spacing: 0px;  border: 1px solid #CCC;}#this>table>tbody>tr.aa_details_inplace>td {  background: #FAFADC;}#this>table>tbody>tr>td {  vertical-align:top;  border-bottom: 1px solid #ccc;  border-top: 0px;  border-left: 1px solid #ccc;  border-right: 0px;  padding: 5px;  color: #404040;  border-collapse: collapse;  border-spacing: 0px;}#this>table>thead>tr>th {  border-left: 1px solid #CCC;  border-bottom: 1px solid #CCC;  background: #eee;  padding: 4px 5px;  cursor:pointer;}#this>table>thead>tr>th>.aa_table_title {  padding-right: 5px;  font-weight: bold;  font-size: 11px;  color: #666;}#this>table>thead>tr>th>.sortArrow {  padding-right: 10px;  cursor:default;}#this>table>thead>tr>th>.aa_table_title:hover {  text-decoration:underline;}#this>table>thead>tr>th.sort_ascending >.sortArrow {  background: url(_jbartImages_/css/sort2.gif) no-repeat 0 5px;}#this>table>thead>tr>th.sort_descending >.sortArrow {  background: url(_jbartImages_/css/sort1.gif) no-repeat 0 5px;}]]></Css>      </View>      <FieldAspect t="itemlist_aspect.ItemSelection"/>      <FieldAspect t="itemlist_aspect.ShowTextWhenNoItems"/>      <Field t="control.Label" ID="_Label" Title="#" Text="%$_ItemIndex%">        <Style t="uitext.PlainText"/>      </Field>      <Field t="control.Button" ID="_Button886" Title="Name" HideTitle="true">        <Style t="btn.Hyperlink"/>        <Disabled value="%$IsRoomClickable% != 'true'"/>        <Action t="action.IfThenElse" If="%$IsManager%">          <Then t="lmc_manager.ShowRoomFromHeaders">&#xa;          </Then>          <Else t="action.IfThenElse" If="%$IsArchive%">            <Then t="popup_confirmation.OpenConfirmationPopup" Question="Are you sure you want to restore the room %@customerName%?" Title="Restore Room">              <Style t="popup_confirmation.GoogleDriveConfirmation"/>              <Action t="async.RunAsyncActions" StopOnError="true">                <Action t="lmc.LMCRestoreRoomFromArchive" RoomID="%@id%"/>                <ProgressStyle t="async_ui.ChangeCursorForProgress"/>              </Action>            </Then>            <Else t="lmc.SetCurrentRoom" RoomID="%@id%" LoadOnly=""/>          </Else>        </Action>        <FieldAspect t="field_feature.Css">          <Css><![CDATA[#wrapper { max-width: 100px; }#this.disabled { color: #000;  cursor: text;}]]></Css>        </FieldAspect>        <ButtonText t="data.IfThenElse" If="%@customerCompany% == ''">          <Then t="text.FirstSucceeding">            <Item value="%@name%"/>            <Item value="%@customerName%"/>          </Then>          <Else value="%@customerName% â€Ž- %@customerCompany%"/>        </ButtonText>      </Field>      <Field t="control.Label" ID="_Label1" Title="Project" Text="%../../@name%">        <Style t="uitext.PlainText"/>        <FieldAspect t="field_aspect.Hidden">          <OnCondition t="field_aspect.CheckConditionOnce" ShowCondition="%$IsManager%"/>        </FieldAspect>      </Field>      <Field t="control.Label" ID="TimeVisited" Title="Minutes" Text="%@visitorTimeMin%">        <Style t="uitext.PlainText"/>        <FieldAspect t="field_aspect.SortType">          <SortType t="itemsort.Numeric"/>        </FieldAspect>      </Field>      <Field t="control.Label" ID="TimeVisited" Title="Joined" Text="%@visitorJoinCount%">        <Style t="uitext.PlainText"/>        <FieldAspect t="field_aspect.SortType">          <SortType t="itemsort.Numeric"/>        </FieldAspect>      </Field>      <Field t="fld.Field" ID="__created" Title="Created" FieldData="%@createdDate%">        <FieldType t="fld_type.Text">          <Style t="uitext.PlainText"/>        </FieldType>        <FieldAspect t="field_aspect.TextSummary" IgnoreEmptyValues="">          <Text t="text.MomentTimeFormat" Time="%%" Format="DD/MM/YY HH:mm"/>        </FieldAspect>      </Field>      <Field t="fld.Field" ID="_customer_activity" Title="Customer Activity" FieldData="%@lastEventTime%">        <FieldType t="fld_type.Text">          <Style t="uitext.PlainText"/>        </FieldType>        <FieldAspect t="field_aspect.TextSummary" IgnoreEmptyValues="">          <Text t="text.MomentTimeFormat" Time="%%" Format="DD/MM/YY HH:mm"/>        </FieldAspect>      </Field>      <Field t="fld.Field" ID="__created" Title="Modified" FieldData="%@modifiedDate%">        <FieldType t="fld_type.Text">          <Style t="uitext.PlainText"/>        </FieldType>        <FieldAspect t="field_aspect.TextSummary" IgnoreEmptyValues="">          <Text t="text.MomentTimeFormat" Time="%%" Format="DD/MM/YY HH:mm"/>        </FieldAspect>      </Field>      <Field t="fld.Field" ID="_agent" Title="Agent" FieldData="%@agent%">        <FieldType t="fld_type.Text">          <Style t="uitext.PlainText"/>        </FieldType>      </Field>      <FieldAspect t="itemsort.TableColumnSort"/>      <Field t="fld.Field" ID="_customerStatus" Title="Status" FieldData="%@customerStatus%">        <FieldType t="fld_type.Text">          <Style t="uitext.PlainText"/>        </FieldType>      </Field>      <Field t="field.DynamicFields" ID="_DynamicFields" Title="Dyanmic Agent Fields">        <FieldItems t="data.IfThenElse" If="%$ProjectSettings/@overrideSiteAgentInfo%" Then="%$ProjectSettings/field%" Else="%$SiteSettings/metadata/field%"/>        <Field t="fld.Field" Title="%@name%">          <FieldType t="fld_type.Text">            <Style t="uitext.PlainText"/>          </FieldType>          <FieldData t="data.Pipeline">            <Item value="%props/@{$ID}%"/>            <Var name="ID" t="text.ToId" Text="%$_FieldItem/@name%"/>          </FieldData>        </Field>      </Field>      <FieldAspect t="itemlist_aspect.TableColumnDragAndDrop">        <CssForDraggedElement><![CDATA[{ opacity: 0.5; border: solid 1px gray; border-radius: 3px; background:transparent url(%$_Images%/css/shadow_bottom_s.png) bottom right no-repeat; padding:0px 10px 10px 0px;}]]></CssForDraggedElement>        <CssForDraggedSpace><![CDATA[{ }]]></CssForDraggedSpace>      </FieldAspect>      <FieldAspect t="itemlist_aspect.LongList" TextForShowMore="Show More...">        <Style t="text_as_item.Default"/>      </FieldAspect>      <Field t="control.Label" ID="_Label2" Title="room id" Text="%@id%">        <Style t="uitext.PlainText"/>        <FieldAspect t="field_aspect.Hidden">          <OnCondition t="field_aspect.CheckConditionOnce" ShowCondition="%$IsArchive%"/>        </FieldAspect>      </Field>    </Field>    <Layout t="layout.Default"/>    <FieldAspect t="itemsort.SortItems" SortDirection="ascending" ItemValueToSort="%@createdDate%">      <SortType t="itemsort.Numeric"/>    </FieldAspect>    <Field t="control.Button" ID="_Button" Title="Export to excel">      <Style t="btn.LMCHyperlink"/>      <Action t="operation.ExportItemlistTableToExcel" Itemlist="rooms_table" ServerBaseUrl="https://jb-letmesee.appspot.com/DownloadCSV" FileName="rooms.csv"/>      <FieldAspect t="field_feature.Layout" dragProperty="#this padding">        <Css><![CDATA[#wrapper {  padding-top:16px;}]]></Css>      </FieldAspect>      <FieldAspect t="field_feature.Hidden" DataForCondition="Item data" WhenHidden="Do not render" ShowCondition="true"/>    </Field>  </xtml></Component><Component id="OpenNewRoomWizard" type="action.Action">  <xtml t="action.RunActions">    <Action t="xml.ChangeXml" Xml="%$Temp%">      <Change t="xml.Delete" Element="%NewRoom%"/>    </Action>    <Action t="popup.OpenPopup" PopupTitle="Create a new customer room">      <Style t="popup.LMCDialog" LightOpacity=""/>      <Contents t="field.InnerPage" Title="Create a new room">        <Layout t="layout.Default"/>        <Field t="control.Layout" ID="_Vertical_Layout" Title="Vertical Layout">          <Layout t="layout.Vertical" Spacing="0"/>          <Field t="control.Page" ID="_Link_to_page5" Title="Link to page">            <Page t="lmc.CreateNewRoomWizard" IsMobile="false"/>          </Field>          <FieldAspect t="field_feature.Css">            <Css><![CDATA[#this {  min-width:500px;}]]></Css>          </FieldAspect>        </Field>      </Contents>    </Action>  </xtml></Component><Component id="OpenNewRoomPopup" type="action.Action">  <Param name="Template"/>  <xtml t="popup.OpenPopup" PopupTitle="Create a new customer room">    <Style t="popup.LMCDialog"/>    <Contents t="field.InnerPage" Title="create room">      <Layout t="layout.Default"/>      <Field t="control.Layout" ID="NewRoom" Title="Vertical Layout">        <Layout t="layout.Vertical" Spacing="30px"/>        <Field t="control.PropertySheet" ID="_Property_Sheet1" Title="Property Sheet">          <Style t="properties.LMCDialogPropertySheet"/>          <Field t="fld.Field" FieldData="%!@customerName%" ID="name" Title="Customer name">            <FieldType t="fld_type.EditableText">              <Style t="editable_text.LMCTextbox" Width="285px"/>            </FieldType>            <FieldAspect t="field_aspect.Mandatory"/>            <FieldAspect t="field_feature.HandleEvent">              <Event t="field_feature.EnterPressed"/>              <Action t="uiaction.Click" RunOn=".fld_OK"/>            </FieldAspect>          </Field>          <Field t="fld.Field" FieldData="%!@customerCompany%" ID="name2" Title="Customer company">            <FieldType t="fld_type.EditableText">              <Style t="editable_text.LMCTextbox" Width="285px"/>            </FieldType>          </Field>          <Field t="fld.Field" FieldData="%!@phone%" ID="phone" Title="Customer phone">            <FieldType t="fld_type.EditableText">              <Style t="editable_text.LMCTextbox" Width="285px"/>            </FieldType>            <FieldAspect t="field_aspect.Validation" AddTitleToErrorMessage="false" CheckValidation="on blur" ErrorMessage="Invalid phone number" ShowErrorMessageNextToField="false">              <ValidationLogic t="validation.MatchesRegularExpression" Expression="[0-9\-+]*"/>            </FieldAspect>          </Field>          <Field t="fld.Field" FieldData="%!@createdByTemplate%" ID="template" Title="Template">            <FieldType t="fld_type.Picklist" AllowEmptyValue="true" AllowValueNotInOptions="">              <Options t="editable_picklist.DynamicOptions" OptionCode="%@id%" OptionDisplayName="%@name%">                <Options t="data.Pipeline">                  <Item t="data.List">                    <Item t="lmc.LMCRoomsInHeaders"/>                    <Item t="data.Pipeline">                      <Item t="lmc.ExternalTemplates"/>                      <Item t="xml.WithChanges">                        <Change t="xml.SetAttribute" AttributeName="id" Value="%@link%"/>                        <Change t="xml.SetAttribute" AttributeName="isTemplate" Value="true"/>                      </Item>                    </Item>                  </Item>                  <Item t="yesno.PassesFilter" Filter="%@isTemplate%"/>                </Options>              </Options>              <Style t="editable_picklist.LMCPicklist" Width="285px"/>            </FieldType>            <FieldAspect t="field_aspect.DefaultValue">              <Value t="text.FirstSucceeding">                <Item value="%$ProjectSettings/@defaultTemplate%"/>                <Item t="data.Pipeline">                  <Item value="%$SiteSettings/templates/defaultTemplate%"/>                  <Item t="yesno.PassesFilter">                    <Filter t="yesno.OR">                      <Item t="data.IsInCommaSeparatedList" Item="%$Project/@id%" List="%@projects%"/>                      <Item t="data.IsInCommaSeparatedList" Item="*" List="%@projects%"/>                    </Filter>                  </Item>                  <Item value="%@link%"/>                </Item>              </Value>            </FieldAspect>          </Field>        </Field>        <FieldAspect t="field_aspect.FieldData">          <FieldData t="data.Pipeline">            <Item t="xml.Xml" DynamicContent="true">              <room/>            </Item>          </FieldData>        </FieldAspect>        <Field t="control.Layout" ID="_Horizontal_Layout" Title="Horizontal Layout">          <Layout t="layout.Horizontal" VerticalLayoutForMobileWidth="false" Spacing="20"/>          <Field t="control.Button" ID="Cancel_Button" Title="Cancel" HideTitle="true">            <Style t="btn.LMCGreyButton" Width="130px"/>            <Action t="popup.CloseContainingPopup" ExitMode=""/>          </Field>          <Field t="control.Button" ID="OK" Title="Create" HideTitle="true">            <Style t="btn.LMCButton" Width="130px" WaitingText="Creating..."/>            <Action t="popup.RunAsyncActionAndCloseContainingPopup">              <Action t="lmc.CreateRoom" IsTemplate="" RoomXml="%%" AllocateNewID="true" WaitForTinyUrl="false">                <DoOnNewRoom t="lmc.SetCurrentRoom" RoomID="%@id%"/>              </Action>            </Action>          </Field>        </Field>      </Field>    </Contents>  </xtml></Component><Component id="OpenDuplicateRoomPopup" type="action.Action">  <Param name="OriginalRoom"/>  <xtml t="popup.OpenPopup" PopupTitle="Duplicate customer room">    <Style t="popup.LMCDialog"/>    <Contents t="field.InnerPage" Title="create room">      <Layout t="layout.Default"/>      <Field t="control.Layout" ID="NewRoom" Title="Vertical Layout">        <Layout t="layout.Vertical" Spacing="30px"/>        <Field t="control.PropertySheet" ID="_Property_Sheet1" Title="Property Sheet">          <Style t="properties.LMCDialogPropertySheet"/>          <Field t="fld.Field" FieldData="%!@customerName%" ID="name" Title="Customer Name">            <FieldType t="fld_type.EditableText">              <Style t="editable_text.LMCTextbox" Width="272px"/>            </FieldType>            <FieldAspect t="field_aspect.Mandatory"/>            <FieldAspect t="field_aspect.DefaultValue">              <Value t="data.Pipeline">                <Item value="Customer %$NextCount%"/>                <Var name="MaxCount" t="data.Pipeline">                  <Item value="%$RoomHeaders/*/@customerName%"/>                  <Item t="text.Split" Separator="Customer " Part="Second"/>                  <Aggregator t="data.Max"/>                  <Item t="yesno.PassesFilter">                    <Filter t="text.MatchesRegex" Expression="[0-9]+"/>                  </Item>                </Var>                <Var name="NextCount" t="data.Math" Expression="%$MaxCount% + 1"/>              </Value>            </FieldAspect>            <FieldAspect t="field_feature.HandleEvent">              <Event t="field_feature.Update"/>              <Action t="action.WriteValue" To="%!../@customerName%" Value="%%"/>            </FieldAspect>            <FieldAspect t="field_feature.HandleEvent">              <Event t="field_feature.EnterPressed"/>              <Action t="uiaction.Click" RunOn=".fld_OK"/>            </FieldAspect>          </Field>        </Field>        <FieldAspect t="field_aspect.FieldData">          <FieldData t="xml.WithChanges" Xml="%$OriginalRoom%">            <Change t="xml.SetAttribute" AttributeName="id" Value=""/>            <Change t="xml.SetAttribute" AttributeName="customerName" Value=""/>            <Change t="xml.SetAttribute" AttributeName="agent" Value="%$User/@name%"/>            <Change t="xml.SetAttribute" AttributeName="url" Value=""/>            <Change t="xml.SetAttribute" AttributeName="tinyUrl" Value=""/>          </FieldData>        </FieldAspect>        <Field t="control.Layout" ID="_Horizontal_Layout" Title="Horizontal Layout">          <Layout t="layout.DialogButtonsRightAlign"/>          <Field t="control.Button" ID="OK" Title="Create" HideTitle="true">            <Style t="btn.LMCButton" Width="130px" WaitingText="Creating..."/>            <Action t="popup.RunAsyncActionAndCloseContainingPopup">              <Action t="lmc.CreateRoom" IsTemplate="" RoomXml="%%">                <DoOnNewRoom t="lmc.SetCurrentRoom" RoomID="%@id%"/>              </Action>            </Action>          </Field>          <Field t="control.Button" ID="Cancel_Button" Title="Cancel" HideTitle="true">            <Style t="btn.LMCGreyButton" Width="130px"/>            <Action t="popup.CloseContainingPopup" ExitMode=""/>          </Field>        </Field>      </Field>    </Contents>  </xtml></Component><Component id="OpenNewTemplatePopup" type="action.Action">  <xtml t="popup.OpenPopup" PopupTitle="Create a template">    <Style t="popup.LMCDialog"/>    <Contents t="field.InnerPage" Title="Create a new template">      <Layout t="layout.Default"/>      <Field t="control.Layout" ID="NewRoom" Title="Vertical Layout">        <Layout t="layout.Vertical" Spacing="30px"/>        <Field t="control.PropertySheet" ID="_Property_Sheet1" Title="Property Sheet">          <Style t="properties.LMCDialogPropertySheet"/>          <Field t="fld.Field" FieldData="%!@name%" ID="name" Title="Template Name">            <FieldType t="fld_type.EditableText">              <Style t="editable_text.LMCTextbox" Width="285px"/>            </FieldType>            <FieldAspect t="field_aspect.Mandatory"/>            <FieldAspect t="field_feature.HandleEvent">              <Event t="field_feature.Update"/>              <Action t="action.WriteValue" To="%!../@name%" Value="%%"/>            </FieldAspect>            <FieldAspect t="field_feature.HandleEvent">              <Event t="field_feature.EnterPressed"/>              <Action t="operation.ClickOnButton" Button="OK"/>            </FieldAspect>          </Field>        </Field>        <FieldAspect t="field_aspect.FieldData">          <FieldData t="xml.Xml" DynamicContent="true">            <room isTemplate="true"/>          </FieldData>        </FieldAspect>        <Field t="control.Layout" ID="_Horizontal_Layout" Title="Horizontal Layout">          <Layout t="layout.Horizontal" VerticalLayoutForMobileWidth="false" Spacing="20"/>          <Field t="control.Button" ID="Cancel_Button" Title="Cancel" HideTitle="true">            <Style t="btn.LMCGreyButton" Width="130px"/>            <Action t="popup.CloseContainingPopup" ExitMode=""/>          </Field>          <Field t="control.Button" ID="OK" Title="Create" HideTitle="true">            <Style t="btn.LMCButton" Width="130px" WaitingText="Creating..." />            <Action t="action.Validate" Group="NewRoom">              <WhenValid t="async.RunAsyncActions" StopOnError="true">                <Action t="lmc.CreateRoom" IsTemplate="" RoomXml="%%">                  <DoOnNewRoom t="lmc.SetCurrentRoom" RoomID="%@id%"/>                </Action>                <Action t="popup.CloseContainingPopup" ExitMode="OK"/>              </WhenValid>            </Action>          </Field>        </Field>      </Field>    </Contents>  </xtml></Component><Component id="LMCRoomsReports" type="jbart.MyWidgetPage">  <Param name="Rooms"/>  <Param name="IsManager" type="data.Boolean"/>  <xtml t="control.Layout" ID="LMCRoomsReports" Title="Reports">    <Field t="control.TabControl" ID="_Accordion" Title="Accordion">      <Style t="ui.CustomCss" base="gstudio.AccordionInStudioPopup">        <Style t="gstudio.AccordionInStudioPopup"/>        <Css><![CDATA[#this >div>div.aatabs_tab {} #this >div>div.aatabs_tab>.aatabs_tab_caption {  cursor:pointer;  height:35px;  line-height:35px;}#this >div>div.aatabs_tab>.aatabs_tab_contents {  padding:10px;}#this >div>div>div>.aatabs_tab_text {  color:#47BAC1;  font:bold 14px arial;  vertical-align:middle;}#this >div>div>.aatabs_tab_caption>div {  display:inline-block;  vertical-align:middle;}#this >div>div>div>.aatabs_tab_toggle {  height:0px;  width:0px;  border:4px solid;  border-color:transparent transparent transparent #47BAC1;  margin:0 6px 0 10px;}#this >div>div.expanded>div>.aatabs_tab_toggle {  border-color:#47BAC1 transparent transparent transparent;  margin:3px 9px 0 7px;}]]></Css>      </Style>      <Field t="control.Layout" ID="_Tab" Title="Timelines">        <Layout t="layout.Default"/>        <Field t="control.Layout" ID="_Horizontal_Layout" Title="Horizontal Layout">          <Layout t="layout.Horizontal" Spacing="15"/>          <Field t="fld.Field" ID="_count" Title="count" FieldData="%!@count%">            <FieldType t="fld_type.EditableNumber">              <Style t="editable_number.Slider" Width="100px"/>              <Format t="number.Format" UseDynamicSymbol="" Min="1">                <DisplayString t="number.ByExpression" Expression="%Symbol%%Value%"/>              </Format>            </FieldType>            <FieldAspect t="field_aspect.DefaultValue" Value="30"/>            <FieldAspect t="field_aspect.RefreshDependentFields" FieldsIds="reports_result" RefreshOn="every click with delay" RefreshScope="screen"/>            <FieldAspect t="field_feature.HandleEvent">              <Event t="field_feature.Update"/>              <Action t="lmc.TrackUserAction" Type="report filter by project" Text="%%"/>            </FieldAspect>          </Field>          <Field t="fld.Field" ID="_resolution" Title="resolution" FieldData="%!@resolution%">            <FieldType t="fld_type.Picklist" AllowEmptyValue="" AllowValueNotInOptions="">              <Options t="editable_picklist.OptionsByCommas" Options="days,weeks,months"/>              <Style t="editable_picklist.JBartPicklist" Width="77px"/>            </FieldType>            <FieldAspect t="field_aspect.DefaultValue" Value="days"/>            <FieldAspect t="field_feature.HandleEvent">              <Event t="field_feature.Update"/>              <Action t="action.RunActions">                <Action t="action.WriteValue" To="%$Temp/reports/!@count%">                  <Value t="text.FirstSucceeding">                    <Item t="data.DataWithCondition" Condition="%% == 'days'" Value="60"/>                    <Item t="data.DataWithCondition" Condition="%% == 'weeks'" Value="10"/>                    <Item t="data.DataWithCondition" Condition="%% == 'months'" Value="6"/>                  </Value>                </Action>                <Action t="field.RefreshField" FireOnUpdate="" FieldID="reports_result,_count" Scope="screen"/>                <Action t="lmc.TrackUserAction" Type="change report resolution" Text="%%"/>              </Action>            </FieldAspect>          </Field>          <Field t="fld.Field" ID="_resolution1" Title="projects" FieldData="%!@projects%">            <FieldType t="fld_type.Picklist" AllowEmptyValue="true" AllowValueNotInOptions="">              <Options t="editable_picklist.DynamicOptions" OptionCode="%@id%" OptionDisplayName="%@name%">                <Options t="data.List">                  <Item value="%$Projects/project%"/>                  <Item value="%$Projects/group%"/>                </Options>              </Options>              <Style t="editable_picklist.JBartPicklist" Width="196px"/>            </FieldType>            <FieldAspect t="field_feature.Layout" dragProperty="#this margin">              <Css><![CDATA[#this { margin-top: 0px; margin-left: 10px; }#wrapper { }]]></Css>            </FieldAspect>            <FieldAspect t="field_aspect.RefreshDependentFields" FieldsIds="reports_result" RefreshOn="every click" RefreshScope="screen"/>            <FieldAspect t="field_aspect.DescriptionForEmptyText" Description="Filter by project or group"/>            <FieldAspect t="field_feature.Hidden" DataForCondition="Item data" WhenHidden="Do not render" ShowCondition="%$Projects/project/@id% != ''"/>          </Field>        </Field>        <Field t="control.Layout" ID="reports_result" Title="Group">          <Field t="chart2.Chart" Title="chart" ID="Chart" ID__Manual="">            <Chart t="ui.CustomStyle" base="googlechart.GoogleColumnChart">              <Html><![CDATA[<div/>]]></Html>              <Css><![CDATA[#this { min-height: 220px;}]]></Css>              <Javascript><![CDATA[function(chart) {  function drawChart() {    var arr = chart.DataMatrix(true);    var data = google.visualization.arrayToDataTable(arr);        var showTextEvery = 1;    var resolution = '%$Temp/reports/@resolution%';    if (resolution == 'days') showTextEvery = 7;    if (resolution == 'weeks') showTextEvery = 3;        var gchart = new google.visualization.AreaChart(chart.control);    var options = {   title: '',   backgroundColor: 'transparent',   colors: ['#3366CC','#549469'],   chartArea:{    left:40,top:10,    width:600,    height:150   },   hAxis: { slantedText: true, textStyle: { fontSize:10 }, showTextEvery: showTextEvery }};    options.title = chart.Title;    gchart.draw(data, options );        google.visualization.events.addListener(gchart, 'select', function(a,b,c) {        try {          var selectedItem = gchart.getSelection()[0];          if (selectedItem) {            var data1 = {              Item: chart.Items[selectedItem.row],          	  Column: selectedItem.column            };            aa_trigger(chart,'drilldownClick',[data1]);          }        } catch(e) {}           });      }  function loadGoogleCharts() {    aa_loadJsFile({     url :'https://www.google.com/jsapi',     variableToFind: 'google',     success: function() {        aa_loadJsFile({          isLoaded: function() { return google.visualization.AreaChart != null; },          loadFunction: function() {            google.load("visualization", "1", {callback:'' , packages:["corechart"]});          },          success: function() {            aa_addOnAttach(chart.control,function() {              drawChart();            });          }        });     }    });  }  loadGoogleCharts();}]]></Javascript>            </Chart>            <Field t="field.Field" ID="name" Title="Name" ReadOnlyText="">              <Type t="field_aspect.Text"/>              <FieldData t="text.FirstSucceeding">                <Item t="data.DataWithCondition" Condition="%$Temp/reports/@resolution% == 'days'">                  <Value t="text.MomentTimeFormat" Time="%From%" Format="ddd DD/MM"/>                </Item>                <Item t="data.DataWithCondition" Condition="%$Temp/reports/@resolution% == 'weeks'">                  <Value t="data.Pipeline">                    <Item value="%$From% - %$To%"/>                    <Var name="From" t="text.MomentTimeFormat" Time="%From%" Format="DD/MM"/>                    <Var name="To" t="text.MomentTimeFormat" Time="%To%" Format="DD/MM"/>                  </Value>                </Item>                <Item t="data.DataWithCondition" Condition="%$Temp/reports/@resolution% == 'months'">                  <Value t="text.MomentTimeFormat" Time="%From%" Format="MMMM YYYY"/>                </Item>              </FieldData>            </Field>            <Field t="field.Field" ID="value" Title="Created" ReadOnlyText="">              <Type t="field_aspect.Number">                <Format t="text.NumberFormat" SymbolAtRight="" MinusInParenthesis="" NoCommaSeparator="" Cents=""/>              </Type>              <FieldData t="data.Pipeline">                <Item value="%Items%"/>                <Aggregator t="data.Count"/>              </FieldData>            </Field>            <Field t="field.Field" ID="value1" Title="Visited" ReadOnlyText="">              <Type t="field_aspect.Number">                <Format t="text.NumberFormat" SymbolAtRight="" MinusInParenthesis="" NoCommaSeparator="" Cents=""/>              </Type>              <FieldData t="data.Pipeline">                <Item value="%Items%"/>                <Item t="yesno.PassesFilter">                  <Filter t="yesno.NotEmpty" Value="%@lastEventTime%"/>                </Item>                <Aggregator t="data.Count"/>              </FieldData>            </Field>            <ChartItems t="data.Pipeline">              <Item t="data.CreateDateRangesFromNow" Resolution="%@resolution%" Count="%@count%"/>              <Item t="object.Object">                <IntegerProperty name="From" value="%From%"/>                <IntegerProperty name="To" value="%To%"/>                <Property name="Items" t="data.Pipeline">                  <Var name="DateRange" value="%%"/>                  <Item t="lmc.LMCRoomsInHeaders" ProjectOrGroup="%$Temp/reports/@projects%" AlsoArchies="true"/>                  <Item t="yesno.PassesFilter">                    <Filter t="yesno.NumberInRange" From="%$DateRange/From%" To="%$DateRange/To%" Data="%@createdDate%"/>                  </Item>                </Property>              </Item>              <Aggregator t="data.ReverseOrder"/>            </ChartItems>            <OnDrilldownClick t="lmc.OpenRoomsInRoomDrillDown">              <Rooms t="data.Pipeline">                <Item value="%Item/Items%"/>                <Var name="IsCreated" t="yesno.ItemsEqual" Item1="%Column%" Item2="1"/>                <Item t="yesno.PassesFilter">                  <Filter t="yesno.OR">                    <Item value="%$IsCreated%"/>                    <Item value="%@lastEventTime% != ''"/>                  </Filter>                </Item>              </Rooms>            </OnDrilldownClick>          </Field>          <Layout t="layout.Vertical" Spacing="18px"/>          <Field t="field.ItemList" Title="items" ID="reports_table">            <View t="itemlist_style.JBartTable" MinWidth="713px" Padding="5px"/>            <FieldAspect t="field_aspect.ItemListContainer">              <Items t="itemlist.Items">                <Items t="data.Pipeline">                  <Item t="data.CreateDateRangesFromNow" Resolution="%@resolution%" Count="%@count%"/>                  <Item t="object.Object">                    <IntegerProperty name="From" value="%From%"/>                    <IntegerProperty name="To" value="%To%"/>                    <Property name="Items" t="data.Pipeline">                      <Var name="DateRange" value="%%"/>                      <Item t="lmc.LMCRoomsInHeaders" ProjectOrGroup="%$Temp/reports/@projects%" AlsoArchies="true"/>                      <Item t="yesno.PassesFilter">                        <Filter t="yesno.NumberInRange" From="%$DateRange/From%" To="%$DateRange/To%" Data="%@createdDate%"/>                      </Item>                    </Property>                  </Item>                </Items>              </Items>            </FieldAspect>            <FieldAspect t="itemlist_aspect.ItemSelection"/>            <FieldAspect t="itemlist_aspect.ShowTextWhenNoItems"/>            <Field t="fld.Field" ID="name" Title="Day">              <FieldType t="fld_type.Text">                <Style t="uitext.PlainText"/>              </FieldType>              <FieldData t="text.FirstSucceeding">                <Item t="data.DataWithCondition" Condition="%$Temp/reports/@resolution% == 'days'">                  <Value t="text.MomentTimeFormat" Time="%From%" Format="ddd DD/MM/YYYY"/>                </Item>                <Item t="data.DataWithCondition" Condition="%$Temp/reports/@resolution% == 'weeks'">                  <Value t="data.Pipeline">                    <Item value="%$From% - %$To%"/>                    <Var name="From" t="text.MomentTimeFormat" Time="%From%" Format="DD/MM/YYYY"/>                    <Var name="To" t="text.MomentTimeFormat" Time="%To%" Format="DD/MM/YYYY"/>                  </Value>                </Item>                <Item t="data.DataWithCondition" Condition="%$Temp/reports/@resolution% == 'months'">                  <Value t="text.MomentTimeFormat" Time="%From%" Format="MMMM YYYY"/>                </Item>              </FieldData>              <FieldAspect t="field_aspect.Title">                <Title t="text.FirstSucceeding">                  <Item value="Day" Condition="%$Temp/reports/@resolution% == 'days'"/>                  <Item value="Week" Condition="%$Temp/reports/@resolution% == 'weeks'"/>                  <Item value="Month" Condition="%$Temp/reports/@resolution% == 'months'"/>                </Title>              </FieldAspect>            </Field>            <Field t="control.Label" ID="_Label1" Title="Created" Text="%=Count(Items)%">              <Style t="uitext.PlainText"/>            </Field>            <Field t="control.Label" ID="_Label2" Title="Visited">              <Style t="uitext.PlainText"/>              <Text t="data.Pipeline">                <Item value="%Items%"/>                <Item t="yesno.PassesFilter">                  <Filter t="yesno.NotEmpty" Value="%@lastEventTime%"/>                </Item>                <Aggregator t="data.Count"/>              </Text>            </Field>            <Field t="control.Label" ID="_Label3" Title="Visit ratio">              <Style t="uitext.PlainText"/>              <Text t="data.Pipeline">                <Var name="Visited" t="data.Pipeline">                  <Item value="%Items%"/>                  <Item t="yesno.PassesFilter">                    <Filter t="yesno.NotEmpty" Value="%@lastEventTime%"/>                  </Item>                  <Aggregator t="data.Count"/>                </Var>                <Var name="Created" value="%=Count(Items)%"/>                <Item t="data.IfThenElse" If="%$Created% == 0">                  <Else t="data.Pipeline">                    <Item t="data.Math" Expression="Math.round( %$Visited% * 100 / %$Created% )"/>                    <Item value="%%\%"/>                  </Else>                </Item>              </Text>            </Field>            <Field t="control.Label" ID="_Label4" Title="Visit total time">              <Style t="uitext.PlainText"/>              <Text t="data.Pipeline">                <Item value="%Items%"/>                <Item value="%@visitorTimeMin%"/>                <Aggregator t="data.Sum"/>                <Aggregator value="%% min"/>              </Text>            </Field>            <Field t="control.Label" ID="_Label5" Title="Visit avg. joins">              <Style t="uitext.PlainText"/>              <Text t="data.Pipeline">                <Item value="%Items%"/>                <Item t="yesno.PassesFilter" Filter="%@visitorJoinCount% &gt; 0"/>                <Item value="%@visitorJoinCount%"/>                <Aggregator t="data.Average" Digits="0"/>              </Text>            </Field>            <FieldAspect t="itemlist_aspect.LongList" TextForShowMore="Show More...">              <Style t="text_as_item.Default"/>            </FieldAspect>          </Field>          <Field t="control.Button" ID="_Button" Title="Export to excel">            <Style t="btn.LMCHyperlink"/>            <Action t="operation.ExportItemlistTableToExcel" Itemlist="reports_table" ServerBaseUrl="https://jb-letmesee.appspot.com/DownloadCSV" FileName="rooms.csv"/>            <FieldAspect t="field_feature.Hidden" DataForCondition="Item data" WhenHidden="Do not render" ShowCondition="true"/>          </Field>        </Field>      </Field>      <Field t="control.Layout" ID="_Tab" Title="Agent performance">        <Layout t="layout.Default"/>        <Field t="fld.Field" ID="_count1" Title="Filter" FieldData="%$Temp/!reports/agents/@daysBack%">          <FieldType t="fld_type.Picklist" AllowEmptyValue="" AllowValueNotInOptions="">            <Options t="editable_picklist.DynamicOptions" OptionDisplayName="%title%" OptionCode="%daysBack%">              <Options t="lmc_manager.DateFilterOptions"/>            </Options>            <Style t="editable_picklist.JBartPicklist" Width="150px"/>          </FieldType>          <FieldAspect t="field_aspect.DefaultValue" Value="7">&#xa;          </FieldAspect>          <FieldAspect t="field_aspect.RefreshDependentFields" FieldsIds="Agent_Chart,Agent_Usage_Chart" RefreshOn="every click with delay" RefreshScope="screen"/>        </Field>        <Field t="control.Label" ID="_Label" Title="Rooms:">          <Style t="ui.CustomCss" base="uitext.PlainText">            <Style t="uitext.PlainText"/>            <Css><![CDATA[#this {  font-weight:bold;}]]></Css>          </Style>          <FieldAspect t="field_feature.Layout" dragProperty="#this margin">            <Css><![CDATA[#this {  margin-top:15px;  margin-left:-6px;  font-size:16px;  margin-bottom:15px;}#wrapper {}]]></Css>          </FieldAspect>        </Field>        <Field t="chart2.Chart" Title="Agent chart" ID="Agent_Chart" ID__Manual="">          <Chart t="ui.CustomStyle" base="googlechart.GoogleColumnChart">            <Html><![CDATA[<div/>]]></Html>            <Css><![CDATA[#this {}]]></Css>            <Javascript><![CDATA[function(chart) {
  aa_lmcDrawAgentPerformanceChart(chart);
}]]></Javascript>          </Chart>          <Field t="field.Field" ID="name" Title="Name" ReadOnlyText="">            <Type t="field_aspect.Text"/>            <FieldData t="data.Pipeline">              <Item value="%Name%â€Ž (%=Count(Created)%) "/>            </FieldData>          </Field>          <Field t="field.Field" ID="value1" Title="Visited" ReadOnlyText="">            <Type t="field_aspect.Number">              <Format t="text.NumberFormat" SymbolAtRight="" MinusInParenthesis="" NoCommaSeparator="" Cents=""/>            </Type>            <FieldData t="data.Pipeline">              <Item value="%Visited%"/>              <Aggregator t="data.Count"/>            </FieldData>          </Field>          <Field t="field.Field" ID="value" Title="Created" ReadOnlyText="">            <Type t="field_aspect.Number">              <Format t="text.NumberFormat" SymbolAtRight="" MinusInParenthesis="" NoCommaSeparator="" Cents=""/>            </Type>            <FieldData t="data.Pipeline">              <Var name="Created" t="data.Pipeline">                <Item value="%Created%"/>                <Aggregator t="data.Count"/>              </Var>              <Var name="Visited" t="data.Pipeline">                <Item value="%Visited%"/>                <Aggregator t="data.Count"/>              </Var>              <Item t="data.Math" Expression="%$Created% - %$Visited%"/>            </FieldData>          </Field>          <ChartItems t="data.Pipeline">            <Item t="lmc_manager.AgentPerformance" DaysBack="%$Temp/reports/agents/@daysBack%">              <Rooms t="lmc.LMCRoomsInHeaders" AlsoArchies="true"/>            </Item>          </ChartItems>          <FieldAspect t="field_feature.Layout" dragProperty="#this margin">            <Css><![CDATA[#this { margin-top: 11px; margin-left: 0; }#wrapper { }]]></Css>          </FieldAspect>          <OnDrilldownClick t="lmc.OpenRoomsInRoomDrillDown">            <Rooms t="data.IfThenElse" Then="%Item/Visited%" Else="%Item/Created%">              <If t="yesno.ItemsEqual" Item1="%Column%" Item2="1"/>            </Rooms>          </OnDrilldownClick>        </Field>        <Field t="control.Layout" ID="_Vertical_Layout" Title="Load user tracking">          <Layout t="layout.Vertical" Spacing="0"/>          <FieldAspect t="async.AsyncActionBeforeLoad" ShowLoadingTextInStudio="">            <LoadingStyle t="loading_style.Default" Height="100px"/>            <Action t="action.ActionByCondition">              <Condition t="yesno.And">                <Item t="yesno.IsEmpty" Value="%$Temp/userTracking%"/>              </Condition>              <Action t="http.HttpCall">                <Url t="data.Pipeline">                  <Item value="/LetMeSee/?op=getUserTracking&amp;site=%$Projects/@site%&amp;key=%$Projects/@key%"/>                </Url>                <OnSuccess t="xml.AddXmlChildren" CloneChildren="false" AddAsFirst="" Parent="%$Temp%" Children="%%"/>              </Action>            </Action>          </FieldAspect>          <FieldAspect t="field_feature.Hidden" DataForCondition="Item data" WhenHidden="Do not render" ShowCondition="%$IsManager% == 'true'"/>          <Field t="control.Label" ID="_Label5" Title="Using Let Me See:">            <Style t="ui.CustomCss" base="uitext.PlainText">              <Style t="uitext.PlainText"/>              <Css><![CDATA[#this { font-weight: bold; }]]></Css>            </Style>            <FieldAspect t="field_feature.Layout" dragProperty="#this margin">              <Css><![CDATA[#this {  margin-top:15px;  margin-left:-6px;  font-size:16px;  margin-bottom:15px;}#wrapper {}]]></Css>            </FieldAspect>          </Field>          <Field t="chart2.Chart" Title="user join count" ID="Agent_Usage_Chart" ID__Manual="">            <Chart t="ui.CustomStyle" base="googlechart.GoogleColumnChart">              <Html><![CDATA[<div/>]]></Html>              <Css><![CDATA[#this {}]]></Css>              <Javascript><![CDATA[
function(chart) {
 function drawChart() {
   var arr = chart.DataMatrix(true);
   if (arr.length < 2) {
     $(chart.control).append('<div>No rooms created</div>');
     return;
   }
   var data = google.visualization.arrayToDataTable(arr);    
   
   var gchart = new google.visualization.BarChart(chart.control);
   var height = 20 + 30*arr.length;
   
    // making sure hAxis ticks have only integer value
    var maxValue = 0;
    for (var i=1; i<arr.length; i++) 
   		maxValue = Math.max(maxValue,arr[i][1]);
    var ticks = [];
    for (var i=0; i<=maxValue; i++)
    	ticks.push(i);
    
   var days = aa_xpath_text( aa_var_first(chart.Context,'Temp'), 'reports/agents/@daysBack' );
   var title = 'Number of days of using Let Me See (out of ' + days + ')';
   var options = {
     fontSize: 12,
     backgroundColor: 'transparent',
     colors: ['#549469','#BAC9E8'],
     isStacked: true,
     height:height,
     chartArea:{
       left:150,top:0,
       width:350,
     },      
     hAxis: { title: title, ticks:ticks, gridlines: {count: -1, color: '#ddd' } }
};
   options.title = chart.Title;
   gchart.draw(data, options );
   
   google.visualization.events.addListener(gchart, 'select', function(a,b,c) {
       try {
         var selectedItem = gchart.getSelection()[0];
         if (selectedItem) {
           var data1 = {
             Item: chart.Items[selectedItem.row],
         	  Column: selectedItem.column
           };
           aa_trigger(chart,'drilldownClick',[data1]);
         }
       } catch(e) {}       
   });
   
 }

 function loadGoogleCharts() {
   aa_loadJsFile({
    url :'https://www.google.com/jsapi',
    variableToFind: 'google',
    success: function() {
       aa_loadJsFile({
         isLoaded: function() { return google.visualization.AreaChart != null; },
         loadFunction: function() {
           google.load("visualization", "1", {callback:'' , packages:["corechart"]});
         },
         success: function() {
           aa_addOnAttach(chart.control,function() {
             drawChart();
           });
         }
       });
    }
   });
 }
 loadGoogleCharts();
}]]></Javascript>            </Chart>            <Field t="field.Field" ID="name" Title="Name" ReadOnlyText="" FieldData="%!@name%">              <Type t="field_aspect.Text"/>            </Field>            <Field t="field.Field" ID="value1" Title="Days of usage" ReadOnlyText="">              <Type t="field_aspect.Number">                <Format t="text.NumberFormat" SymbolAtRight="" MinusInParenthesis="" NoCommaSeparator="" Cents=""/>              </Type>              <FieldData t="data.Pipeline">                <Item value="%userStats/entry%"/>                <Aggregator t="data.Count"/>                <Item t="yesno.PassesFilter">                  <Filter t="yesno.And">                    <Item value="%@join% != ''"/>                    <Item value="%@join% != 0"/>                    <Item value="%@id% != ''"/>                    <Item t="lmc_manager.IsUserTrackingInDateRange" DateString="%@id%" DaysBack="%$Temp/reports/agents/@daysBack%"/>                  </Filter>                </Item>              </FieldData>            </Field>            <FieldAspect t="field_feature.Layout" dragProperty="#this margin">              <Css><![CDATA[#this { margin-top: 11px; margin-left: 0; }]]></Css>            </FieldAspect>            <ChartItems value="%$Temp/userTracking/user%"/>          </Field>        </Field>      </Field>    </Field>    <Layout t="layout.Vertical" Spacing="10px"/>    <FieldAspect t="field_aspect.FieldData" FieldData="%$Temp/!reports%">&#xa;    </FieldAspect>  </xtml></Component><Component id="OpenRoomsInRoomDrillDown" type="action.Action">  <Param name="Rooms"/>  <xtml t="popup.OpenPopup">    <Style t="popup.LMCDialog" LightOpacity=""/>    <Contents t="field.InnerPage" Title="Drilldown">      <Layout t="layout.Default"/>      <Field t="control.Layout" ID="_Group" Title="table">        <Field t="control.Page" ID="_Link_to_page5" Title="rooms table">          <Page t="lmc.RoomsTable" IsRoomClickable="false">            <IsManager t="yesno.NotEmpty" Value="%$Projects/project%"/>            <Rooms value="%$Rooms%"/>          </Page>        </Field>        <Layout t="layout.Default"/>        <FieldAspect t="field_aspect.DynamicSize">          <Height t="scroll_size.DeviceHeight" ReduceHeightOfOtherField="" StretchFromCurrentLocation="false" ReducePixels="250px" ApplyOn="height"/>        </FieldAspect>      </Field>      <Field t="control.Layout" ID="popup_buttons" Title="Buttons">        <Layout t="layout.DialogButtonsRightAlign"/>        <Field t="control.Button" ID="Cancel" Title="Close">          <Style t="btn.LMCGreyButton" Width="140px"/>          <Action t="popup.CloseContainingPopup" ExitMode=""/>          <FieldAspect t="field_feature.HandleEvent">            <Event t="field_feature.AfterRenderingControl"/>            <Action t="async.RunOnNextTimer" Milliseconds="300">              <Action t="lmc.TrackUserAction" Type="report drill down">                <Text t="data.JavaScript" Code="function(data,html_elem,context) {&#xa; var $el = $(context.vars.ControlElement);&#xa;var title = $el.closest('.aa_popup_frame').find('.aa_popup_title').text();&#xa;return title;&#xa;}"/>              </Action>            </Action>          </FieldAspect>        </Field>        <FieldAspect t="field_feature.Layout">          <Css><![CDATA[#this { margin-top: 20px; }]]></Css>        </FieldAspect>      </Field>    </Contents>    <PopupTitle t="data.Pipeline">      <Var name="Verb" t="data.IfThenElse" If="%Column% == 1" Then="created" Else="visited"/>      <Var name="From" t="text.FirstSucceeding">        <Item t="data.DataWithCondition" Condition="%$Temp/reports/@resolution% == 'days'">          <Value t="text.MomentTimeFormat" Time="%Item/From%" Format="ddd DD/MM/YYYY"/>        </Item>        <Item t="data.DataWithCondition" Condition="%$Temp/reports/@resolution% == 'weeks'">          <Value t="data.Pipeline">            <Item value="%$From% - %$To%"/>            <Var name="From" t="text.MomentTimeFormat" Time="%Item/From%" Format="DD/MM/YYYY"/>            <Var name="To" t="text.MomentTimeFormat" Time="%Item/To%" Format="DD/MM/YYYY"/>          </Value>        </Item>        <Item t="data.DataWithCondition" Condition="%$Temp/reports/@resolution% == 'months'">          <Value t="text.MomentTimeFormat" Time="%Item/From%" Format="MMMM YYYY"/>        </Item>      </Var>      <Item value="Rooms %$Verb% at %$From%"/>    </PopupTitle>  </xtml></Component></xtml>